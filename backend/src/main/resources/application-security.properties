# Security Configuration for Cloud Deployment
# Addresses Issue #51: Conduct Security Testing on Cloud Deployment

# Rate Limiting Configuration
modulo.security.rate-limit.enabled=true
modulo.security.rate-limit.requests-per-minute=100
modulo.security.rate-limit.burst-capacity=20

# Security Headers Configuration
modulo.security.headers.hsts.enabled=true
modulo.security.headers.hsts.max-age=31536000
modulo.security.headers.hsts.include-subdomains=true
modulo.security.headers.content-type-options.enabled=true
modulo.security.headers.frame-options.enabled=true
modulo.security.headers.frame-options.value=DENY
modulo.security.headers.xss-protection.enabled=true
modulo.security.headers.referrer-policy.enabled=true
modulo.security.headers.referrer-policy.value=strict-origin-when-cross-origin
modulo.security.headers.permissions-policy.enabled=true

# Content Security Policy
modulo.security.csp.enabled=true
modulo.security.csp.default-src='self'
modulo.security.csp.script-src='self' 'unsafe-inline'
modulo.security.csp.style-src='self' 'unsafe-inline'
modulo.security.csp.img-src='self' data: https:
modulo.security.csp.connect-src='self'
modulo.security.csp.font-src='self'
modulo.security.csp.object-src='none'
modulo.security.csp.media-src='self'
modulo.security.csp.frame-src='none'

# CORS Configuration for Production
modulo.security.cors.enabled=true
modulo.security.cors.allowed-origins=https://modulo-app.com,https://www.modulo-app.com
modulo.security.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
modulo.security.cors.allowed-headers=Content-Type,Authorization,X-Requested-With,Accept
modulo.security.cors.exposed-headers=X-RateLimit-Limit,X-RateLimit-Remaining,X-RateLimit-Reset
modulo.security.cors.allow-credentials=true
modulo.security.cors.max-age=3600

# Session Management
modulo.security.session.timeout=1800
modulo.security.session.cookie.secure=true
modulo.security.session.cookie.http-only=true
modulo.security.session.cookie.same-site=strict

# OAuth2 Security Settings
modulo.security.oauth2.session-creation-policy=STATELESS
modulo.security.oauth2.remember-me.enabled=false

# Security Testing Configuration (DISABLE IN PRODUCTION)
modulo.security.testing.enabled=false
modulo.security.testing.api-key=

# Audit Logging
modulo.security.audit.enabled=true
modulo.security.audit.log-all-requests=false
modulo.security.audit.log-failed-auth=true
modulo.security.audit.log-authorization-failures=true
modulo.security.audit.log-suspicious-activity=true

# SSL/TLS Configuration
server.ssl.enabled=true
server.ssl.protocol=TLS
server.ssl.enabled-protocols=TLSv1.2,TLSv1.3
server.ssl.ciphers=TLS_AES_256_GCM_SHA384,TLS_CHACHA20_POLY1305_SHA256,TLS_AES_128_GCM_SHA256,ECDHE-RSA-AES256-GCM-SHA384,ECDHE-RSA-AES128-GCM-SHA256

# Database Security
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

# JPA Security
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.hibernate.ddl-auto=validate

# Actuator Security (Production)
management.endpoints.enabled-by-default=false
management.endpoint.health.enabled=true
management.endpoint.info.enabled=true
management.endpoints.web.base-path=/actuator
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized

# Logging Security
logging.level.com.modulo.security=INFO
logging.level.SECURITY_AUDIT=INFO
logging.pattern.console=%d{ISO8601} [%thread] %-5level [%X{eventType:-}] [%X{eventId:-}] %logger{36} - %msg%n
logging.pattern.file=%d{ISO8601} [%thread] %-5level [%X{eventType:-}] [%X{eventId:-}] [%X{riskLevel:-}] %logger{36} - %msg%n
