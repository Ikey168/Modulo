# Performance Optimization Configuration for Issue #50
# API Response Time Improvements

# Database Performance Settings
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# JPA/Hibernate Performance Optimizations
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.use_sql_comments=false
spring.jpa.properties.hibernate.generate_statistics=false

# Query performance optimizations
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.jdbc.fetch_size=100
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.batch_versioned_data=true

# Second-level cache (if using Hibernate with cache provider)
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.use_query_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.jcache.internal.JCacheRegionFactory

# Connection pool monitoring
spring.datasource.hikari.register-mbeans=true

# Cache Configuration
spring.cache.type=simple
spring.cache.cache-names=notes,notesByUser,notesByTag,notesSearch,tags,users,attachments,metadata

# Actuator for monitoring
management.endpoints.web.exposure.include=health,metrics,caches,info,performance
management.endpoint.health.show-details=always
management.endpoint.metrics.enabled=true
management.endpoint.caches.enabled=true
management.metrics.export.simple.enabled=true

# Logging configuration for performance monitoring
logging.level.com.modulo.aspect.PerformanceMonitoringAspect=INFO
logging.level.com.modulo.service.OptimizedNoteService=DEBUG
logging.level.com.modulo.repository.jpa.OptimizedNoteRepository=DEBUG

# Enable lazy loading optimization
spring.jpa.open-in-view=false

# Enable batch processing
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# Enable SQL query plan caching
spring.jpa.properties.hibernate.query.plan_cache_max_size=512
spring.jpa.properties.hibernate.query.plan_parameter_metadata_max_size=128

# Optimize for SSD storage
spring.jpa.properties.hibernate.dialect.storage_engine=innodb

# Performance monitoring settings
modulo.performance.monitoring.enabled=true
modulo.performance.monitoring.slow-threshold-ms=1000
modulo.performance.monitoring.very-slow-threshold-ms=5000
modulo.performance.monitoring.log-all-queries=false
modulo.performance.monitoring.log-slow-queries=true

# Cache settings
modulo.cache.default-ttl=300000
modulo.cache.max-entries=10000
modulo.cache.cleanup-interval=600000

# API Response optimization
server.compression.enabled=true
server.compression.mime-types=application/json,application/xml,text/html,text/xml,text/plain,application/javascript,text/css
server.compression.min-response-size=1024

# Thread pool optimization for async processing
spring.task.execution.pool.core-size=8
spring.task.execution.pool.max-size=20
spring.task.execution.pool.queue-capacity=100
spring.task.execution.thread-name-prefix=modulo-async-

# Database query timeout settings
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.validation-timeout=5000
spring.transaction.default-timeout=30

# Performance optimization flags
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true
