# Integration Test Configuration
# This configuration is specifically for end-to-end integration tests

# Database Configuration (will be overridden by TestContainers)
spring.datasource.url=jdbc:postgresql://localhost:5432/modulo_integration_test
spring.datasource.username=integration_test_user
spring.datasource.password=integration_test_pass
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA Configuration for Integration Tests
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.use_sql_comments=false

# Test Security Configuration
modulo.security.jwt-secret=dGVzdC1pbnRlZ3JhdGlvbi1qd3Qtc2VjcmV0LWZvci1lbmQtdG8tZW5kLXRlc3RpbmctMTIzNDU2Nzg5MA==
modulo.security.api-key=integration_test_api_key_12345
modulo.security.encryption-key=integration-test-encryption-key

# External Service URLs (will be overridden by WireMock in tests)
modulo.external.openai-api-url=http://localhost:8090
modulo.external.openai-api-key=test-openai-api-key
modulo.external.ipfs-api-url=http://localhost:8091
modulo.external.ipfs-gateway-url=http://localhost:8092

# Blockchain Configuration for Testing
blockchain.network.rpc-url=http://localhost:8089
blockchain.network.chain-id=31337
blockchain.contract.address=0x742d35C8dbD20A1BfD6fD6B10E4B3F5e4B6E8Db8
blockchain.private-key=0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
blockchain.enabled=true

# Server Configuration
server.port=0
management.server.port=0

# Logging Configuration for Integration Tests
logging.level.com.modulo=INFO
logging.level.org.springframework=WARN
logging.level.org.hibernate=WARN
logging.level.org.testcontainers=INFO
logging.level.com.github.tomakehurst.wiremock=WARN

# Test-specific properties
spring.test.database.replace=none

# Disable unnecessary auto-configurations for faster test startup
spring.autoconfigure.exclude=\
  org.springframework.boot.autoconfigure.security.oauth2.client.servlet.OAuth2ClientAutoConfiguration,\
  org.springframework.boot.autoconfigure.security.oauth2.resource.servlet.OAuth2ResourceServerAutoConfiguration

# Cache Configuration (disable for tests)
spring.cache.type=none

# Async Configuration for Tests
spring.task.execution.pool.core-size=2
spring.task.execution.pool.max-size=4
spring.task.execution.pool.queue-capacity=100

# WebSocket Configuration (simplified for tests)
modulo.websocket.allowed-origins=*
modulo.websocket.endpoint=/ws

# Rate Limiting (relaxed for tests)
modulo.rate-limiting.enabled=false

# Actuator Configuration for Integration Tests
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always
management.health.defaults.enabled=false

# Integration Test Markers
spring.profiles.active=integration-test

# TestContainers Configuration
testcontainers.reuse.enable=false
